# Phylogenetic Analysis Using `phangorn` in R

This repository contains an example of phylogenetic analysis using the R package `phangorn`. The analysis covers both distance-based and character-based methods (NJ, UPGMA, Parsimony), including bootstrap evaluation and tree comparison.

---

## Requirements

Make sure you have the following R packages installed:
```r
install.packages("ape")
install.packages("phangorn")
install.packages("igraph") # optional, used in some visualizations


## Step 1: Load Data

We begin by loading the required packages and reading the DNA alignment data (`primates.dna`) included in the `phangorn` package.

library(ape)
library(phangorn)

fdir <- system.file("extdata/trees", package = "phangorn")
primates <- read.phyDat(file.path(fdir, "primates.dna"), format = "interleaved")

## Step 2: Reconstruct Trees (Distance-Based)
Create a distance matrix using dist.ml(), then build trees using UPGMA and Neighbor Joining (NJ) methods.
```r
dm <- dist.ml(primates)
treeUPGMA <- upgma(dm)
treeNJ <- NJ(dm)
```
## Step 3: Visualize Trees
```r
plot(treeUPGMA, main="UPGMA Tree")       # Rooted
plot(treeNJ, main="Neighbor Joining Tree")  # Unrooted
```
## Step 4: Bootstrap Analysis
```r
Bootstrap for UPGMA Tree:
fun <- function(x) upgma(dist.ml(x))
bs_upgma <- bootstrap.phyDat(primates, fun)
plotBS(treeUPGMA, bs_upgma, main="UPGMA with Bootstrap")
Bootstrap for NJ Tree:
fun2 <- function(x) nj(dist.ml(x))
bs_nj <- bootstrap.phyDat(primates, fun2)
plotBS(treeNJ, bs_nj, main="NJ with Bootstrap")
```
## Interpretation:
Different outgroups: UPGMA = Mouse, NJ = Bovine
Indicates different evolutionary perspectives depending on method
Bootstrap support: Higher in NJ tree, suggesting stronger support and more consistency across resampling

## Part B: Character-Based Method (Parsimony)
Calculate parsimony scores:
parsimony(treeUPGMA, primates)  # [1] 751
parsimony(treeNJ, primates)     # [1] 746

Construct Parsimony Tree with pratchet:
```r
treeRatchet <- pratchet(primates, trace = 0, minit = 100)
parsimony(treeRatchet, primates)  # [1] 746
Finalize the tree (optimize branch lengths and remove zero-length edges):
treeRatchet <- acctran(treeRatchet, primates)
treeRatchet <- di2multi(treeRatchet)

if(inherits(treeRatchet, "multiPhylo")){
  treeRatchet <- unique(treeRatchet)
}
```
## Visualize Parsimony Tree with Bootstrap Support:
```r
plotBS(midpoint(treeRatchet), type="phylogram")
add.scale.bar()
```
## Interpretation:
Outgroup: Bovine â€” based on minimum evolutionary changes
Bootstrap value: Indicates how many times a branch was recovered during 100 resampling iterations (e.g., 0.66 = 66 times)
